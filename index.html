<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAC Motors | Sistema de Cotizaci√≥n Avanzado</title>
    <!-- Incluir librer√≠as -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        body { 
            background: #ffffff;
            color: #333333;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* VARIABLES DE COLOR */
        :root {
            --ferrari-red: #d40000;
            --ferrari-red-dark: #a80000;
            --ferrari-red-light: #ff0000;
            --ferrari-red-glow: rgba(212, 0, 0, 0.6);
            --ferrari-red-glow-light: rgba(212, 0, 0, 0.1);
            --admin-dark: #1a1a2e;
            --admin-darker: #16213e;
            --admin-accent: #0f3460;
            --admin-highlight: #e94560;
        }
        
        /* CONTENEDOR DE LOGOS */
        .logos-container {
            margin-bottom: 30px;
            text-align: center;
            animation: fadeIn 1s ease-out;
        }

        .logo-pair {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            flex-wrap: wrap;
        }

        .gac-logo-img, .dfsk-logo-img {
            height: 160px;
            width: auto;
            border-radius: 15px;
            box-shadow: 
                0 0 20px var(--ferrari-red-glow-light),
                0 0 40px rgba(212, 0, 0, 0.1);
            filter: brightness(1.1) contrast(1.1);
            transition: all 0.5s ease;
        }

        .gac-logo-img:hover, .dfsk-logo-img:hover {
            transform: scale(1.05);
            box-shadow: 
                0 0 30px var(--ferrari-red-glow-light),
                0 0 60px rgba(212, 0, 0, 0.15);
        }
        
        /* HEADER PRINCIPAL */
        .hero-header {
            background: 
                linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 248, 248, 0.98) 100%),
                url('https://br-www-resouce-cdn.gacgroup.com/static/Global/tenant/cms/common/202503/acd070ba-2958-4119-a246-9e8fbb408de3.webp');
            background-size: cover;
            background-position: center 40%;
            background-attachment: fixed;
            height: 85vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #333333;
            position: relative;
            overflow: hidden;
        }

        .hero-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(212, 0, 0, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(212, 0, 0, 0.03) 0%, transparent 50%),
                radial-gradient(circle at center, transparent 0%, rgba(255, 255, 255, 0.8) 70%);
            z-index: 1;
        }
        
        .hero-content {
            max-width: 900px;
            padding: 60px 50px;
            position: relative;
            z-index: 2;
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.8);
            border-radius: 30px;
            border: 2px solid var(--ferrari-red);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            animation: fadeIn 1.2s ease-out;
        }
        
        .gac-logo {
            font-size: 1.6em;
            letter-spacing: 4px;
            text-transform: uppercase;
            margin-bottom: 20px;
            color: var(--ferrari-red);
            font-weight: 600;
            text-shadow: 0 0 10px var(--ferrari-red-glow-light);
        }
        
        .hero-content h1 {
            font-size: 4.2em;
            font-weight: 300;
            margin-bottom: 20px;
            letter-spacing: 3px;
            color: #333333;
            text-shadow: 0 0 10px var(--ferrari-red-glow-light);
        }
        
        .hero-content .subtitle {
            font-size: 1.3em;
            font-weight: 300;
            margin-bottom: 40px;
            color: #666666;
            letter-spacing: 1.5px;
            line-height: 1.8;
        }
        
        .gac-divider {
            width: 200px;
            height: 3px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(212, 0, 0, 0.3), 
                var(--ferrari-red), 
                rgba(212, 0, 0, 0.3), 
                transparent);
            margin: 40px auto;
            border-radius: 2px;
            box-shadow: 0 0 10px var(--ferrari-red-glow-light);
        }
        
        /* CONTENEDOR PRINCIPAL */
        .main-container {
            background: linear-gradient(135deg, #ffffff, #f8f8f8);
            margin-top: -80px;
            position: relative;
            z-index: 2;
            border-radius: 50px 50px 0 0;
            box-shadow: 
                0 -25px 60px var(--ferrari-red-glow-light),
                inset 0 1px 0 var(--ferrari-red);
            min-height: 70vh;
        }
        
        .inventory-section {
            padding: 100px 40px 80px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* BOT√ìN ADMIN SECRETO */
        .admin-btn {
            background: linear-gradient(135deg, var(--admin-dark), var(--admin-accent));
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.2),
                0 2px 5px rgba(0, 0, 0, 0.1);
            transition: all 0.4s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            opacity: 0.3;
        }
        
        .admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.3),
                0 4px 10px rgba(0, 0, 0, 0.2);
            background: linear-gradient(135deg, var(--admin-accent), var(--admin-dark));
            opacity: 1;
        }

        /* CONTROLES AVANZADOS */
        .advanced-controls {
            background: linear-gradient(135deg, #ffffff, #f8f8f8);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 var(--ferrari-red);
            border: 2px solid var(--ferrari-red);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-label {
            font-weight: 600;
            color: var(--ferrari-red);
            font-size: 0.9em;
        }

        .search-box, .stock-filter, .brand-filter, .model-filter {
            padding: 12px 15px;
            border: 2px solid rgba(212, 0, 0, 0.2);
            border-radius: 10px;
            font-size: 14px;
            background: white;
            transition: all 0.3s ease;
        }

        .search-box:focus, .stock-filter:focus, .brand-filter:focus, .model-filter:focus {
            outline: none;
            border-color: var(--ferrari-red);
            box-shadow: 0 0 10px var(--ferrari-red-glow-light);
        }

        /* BOTONES */
        .quote-btn {
            background: linear-gradient(135deg, var(--ferrari-red), var(--ferrari-red-dark));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 
                0 4px 15px rgba(212, 0, 0, 0.3),
                0 2px 5px rgba(212, 0, 0, 0.2);
            transition: all 0.4s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .quote-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 
                0 8px 25px rgba(212, 0, 0, 0.4),
                0 4px 10px rgba(212, 0, 0, 0.3);
        }

        .quote-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* INDICADOR DE ACTUALIZACI√ìN */
        .update-indicator {
            background: linear-gradient(135deg, #f8f8f8, #ffffff);
            padding: 15px 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            border: 2px solid rgba(212, 0, 0, 0.2);
            font-weight: 600;
            color: #666;
        }

        /* LOADING */
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #666;
            font-size: 16px;
        }

        .gac-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(212, 0, 0, 0.2);
            border-top: 4px solid var(--ferrari-red);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ERROR */
        .error {
            background: #ffe6e6;
            color: #d40000;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #ffcccc;
            margin: 20px 0;
        }

        /* TABLA MEJORADA */
        .table-container {
            background: linear-gradient(135deg, #ffffff, #f8f8f8);
            border-radius: 30px;
            overflow: hidden;
            box-shadow: 
                0 25px 60px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 var(--ferrari-red);
            border: 2px solid var(--ferrari-red);
            animation: fadeIn 1.2s ease-out;
        }

        .inventory-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            background: transparent;
        }

        .inventory-table th {
            background: linear-gradient(135deg, #ffffff, #f8f8f8);
            color: var(--ferrari-red);
            padding: 20px 16px;
            text-align: left;
            font-weight: 600;
            font-size: 12px;
            position: sticky;
            top: 0;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            border-bottom: 3px solid var(--ferrari-red);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .inventory-table td {
            padding: 16px;
            border-bottom: 1px solid rgba(212, 0, 0, 0.2);
            font-size: 13px;
            line-height: 1.4;
            color: #333333;
            font-weight: 400;
        }

        .inventory-table tr:hover {
            background: rgba(212, 0, 0, 0.05);
        }

        .quantity-input {
            width: 70px;
            padding: 8px 10px;
            border: 2px solid rgba(212, 0, 0, 0.2);
            border-radius: 6px;
            text-align: center;
            font-weight: 600;
        }

        .quantity-input:focus {
            outline: none;
            border-color: var(--ferrari-red);
            box-shadow: 0 0 5px var(--ferrari-red-glow-light);
        }

        /* PANEL DE COTIZACI√ìN */
        .quote-panel {
            background: linear-gradient(135deg, #ffffff, #f8f8f8);
            padding: 30px;
            border-radius: 20px;
            margin-top: 30px;
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 var(--ferrari-red);
            border: 2px solid var(--ferrari-red);
            display: none;
        }

        .quote-items {
            max-height: 300px;
            overflow-y: auto;
            margin: 20px 0;
            padding: 15px;
            background: rgba(212, 0, 0, 0.05);
            border-radius: 10px;
        }

        .quote-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            border-bottom: 1px solid rgba(212, 0, 0, 0.1);
        }

        .quote-item:last-child {
            border-bottom: none;
        }

        .quote-total {
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            color: var(--ferrari-red);
            padding: 20px;
            background: rgba(212, 0, 0, 0.1);
            border-radius: 10px;
            margin: 20px 0;
        }

        /* PANEL DE ADMINISTRADOR AVANZADO */
        .admin-panel {
            background: linear-gradient(135deg, var(--admin-dark), var(--admin-darker));
            padding: 30px;
            border-radius: 20px;
            margin-top: 40px;
            box-shadow: 
                0 20px 50px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 2px solid var(--admin-highlight);
            display: none;
            color: white;
        }

        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid var(--admin-accent);
            padding-bottom: 15px;
        }

        .admin-tab {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #bdc3c7;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .admin-tab.active {
            background: var(--admin-highlight);
            color: white;
        }

        .admin-tab:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        /* GR√ÅFICOS Y ESTAD√çSTICAS */
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chart-title {
            color: #ecf0f1;
            margin-bottom: 15px;
            font-size: 1.1em;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: var(--admin-highlight);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            color: #bdc3c7;
        }

        .replenishment-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* ANIMACIONES */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .hero-content {
                padding: 40px 20px;
                margin: 15px;
            }
            
            .hero-content h1 {
                font-size: 2.5em;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .admin-tabs {
                flex-wrap: wrap;
            }
            
            .admin-btn {
                top: 10px;
                right: 10px;
                padding: 8px 15px;
                font-size: 12px;
            }

            .logo-pair {
                gap: 20px;
            }

            .gac-logo-img, .dfsk-logo-img {
                height: 100px;
            }
        }
    </style>
</head>
<body>
    <!-- BOT√ìN ADMIN SECRETO -->
    <button class="admin-btn" id="adminToggle" style="display: none;">üîì Admin</button>

    <!-- HEADER PRINCIPAL -->
    <header class="hero-header">
        <div class="hero-content">
            <div class="logos-container">
                <div class="logo-pair">
                    <img src="https://br-www-resouce-cdn.gacgroup.com/static/Global/tenant/cms/common/202503/acd070ba-2958-4119-a246-9e8fbb408de3.webp" 
                         alt="GAC EMPOW" class="gac-logo-img">
                    <img src="https://static.wixstatic.com/media/ccd68f_12a5a4cad7ee4633ab365d38ab26a056~mv2.png/v1/crop/x_1306,y_0,w_7398,h_5621/fill/w_644,h_490,al_c,q_85,usm_0.66_1.00_0.01,enc_avif,quality_auto/9%E6%9C%8825%E5%8F%B7-4%E4%B8%9C%E9%A3%8E36029203.png" 
                         alt="DFSK Motor" class="dfsk-logo-img">
                </div>
            </div>
            
            <div class="gac-logo">GAC MOTOR / DFSK MOTOR</div>
            <h1>Sistema de Cotizaci√≥n Avanzado</h1>
            <div class="gac-divider"></div>
            <p class="subtitle">Gesti√≥n inteligente de inventario y an√°lisis predictivo</p>
        </div>
    </header>
    
    <!-- CONTENIDO PRINCIPAL -->
    <main class="main-container">
        <section class="inventory-section">
            <!-- ENCABEZADO -->
            <div class="section-header">
                <div class="gac-badge">Sistema de Cotizaci√≥n v2.0</div>
                <h2 class="section-title">Gesti√≥n de Inventario Inteligente</h2>
                <p class="section-subtitle">Control avanzado de stock y an√°lisis predictivo de demanda</p>
            </div>

            <!-- CONTROLES AVANZADOS -->
            <div class="advanced-controls">
                <div class="controls-grid">
                    <div class="control-group">
                        <label class="control-label">üîç B√∫squeda Avanzada</label>
                        <input type="text" class="search-box" id="searchInput" 
                               placeholder="Buscar por c√≥digo, descripci√≥n, n√∫mero de parte...">
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">üìä Filtro de Stock</label>
                        <select class="stock-filter" id="stockFilter">
                            <option value="all">Todo el stock</option>
                            <option value="critical">Stock Cr√≠tico (< 5)</option>
                            <option value="low">Stock Bajo (0)</option>
                            <option value="medium">Stock Medio (1-10)</option>
                            <option value="high">Stock Alto (>10)</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label class="control-label">üè∑Ô∏è Filtro por Marca</label>
                        <select class="brand-filter" id="brandFilter">
                            <option value="all">Todas las marcas</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label class="control-label">üöó Filtro por Modelo</label>
                        <select class="model-filter" id="modelFilter">
                            <option value="all">Todos los modelos</option>
                        </select>
                    </div>
                </div>

                <div style="display: flex; gap: 15px; justify-content: center;">
                    <button class="quote-btn" id="generateQuote" disabled>
                        üìã Generar Cotizaci√≥n
                    </button>
                    <button class="quote-btn" id="quickActions" style="background: #3498db;">
                        ‚ö° Acciones R√°pidas
                    </button>
                </div>
            </div>
            
            <!-- INDICADOR DE ACTUALIZACI√ìN -->
            <div class="update-indicator">
                <span>üîÑ Sistema actualizado:</span> 
                <span id="update-time">Cargando an√°lisis en tiempo real...</span>
            </div>
            
            <!-- TABLA PRINCIPAL -->
            <div class="table-container">
                <div id="loading-message" class="loading">
                    <div class="gac-spinner"></div>
                    <div>Analizando inventario y tendencias...</div>
                    <small style="margin-top: 20px; display: block; opacity: 0.7; color: #666666;">
                        Cargando datos hist√≥ricos y predicciones
                    </small>
                </div>
                
                <div id="error-message" class="error" style="display: none;"></div>
                
                <div style="overflow-x: auto;">
                    <table class="inventory-table" id="inventory-table" style="display: none;">
                        <thead>
                            <tr>
                                <th>C√≥digo</th>
                                <th>Marca</th>
                                <th>Serie</th>
                                <th>Modelo</th>
                                <th>N√∫mero de Parte</th>
                                <th>Descripci√≥n</th>
                                <th>Stock</th>
                                <th>Tendencia</th>
                                <th>Cantidad a Cotizar</th>
                            </tr>
                        </thead>
                        <tbody id="inventory-body"></tbody>
                    </table>
                </div>
            </div>
            
            <!-- PANEL DE COTIZACI√ìN -->
            <div class="quote-panel" id="quotePanel">
                <h3>üìÑ Cotizaci√≥n Generada - An√°lisis Incluido</h3>
                <div class="quote-items" id="quoteItems"></div>
                <div class="quote-total" id="quoteTotal">
                    Total de items seleccionados: <span id="totalItems">0</span>
                </div>
                <div style="text-align: center;">
                    <button class="quote-btn" onclick="generatePDF()">
                        üì• Descargar PDF con An√°lisis
                    </button>
                    <button class="quote-btn" onclick="clearQuote()" style="background: #cccccc; margin-left: 15px;">
                        üóëÔ∏è Limpiar Cotizaci√≥n
                    </button>
                </div>
            </div>

            <!-- PANEL DE ADMINISTRADOR AVANZADO -->
            <div class="admin-panel" id="adminPanel">
                <h3 style="text-align: center; color: var(--admin-highlight); margin-bottom: 20px;">
                    üõ†Ô∏è PANEL DE ADMINISTRADOR - AN√ÅLISIS AVANZADO
                </h3>
                
                <!-- PESTA√ëAS -->
                <div class="admin-tabs">
                    <button class="admin-tab active" onclick="switchTab('dashboard')">üìä Dashboard</button>
                    <button class="admin-tab" onclick="switchTab('analytics')">üìà Analytics</button>
                    <button class="admin-tab" onclick="switchTab('predictions')">üîÆ Predicciones</button>
                    <button class="admin-tab" onclick="switchTab('management')">‚öôÔ∏è Gesti√≥n</button>
                </div>

                <!-- DASHBOARD -->
                <div id="dashboard" class="tab-content active">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="totalProducts">0</div>
                            <div class="stat-label">Productos Totales</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="criticalStock">0</div>
                            <div class="stat-label">Stock Cr√≠tico</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="totalRequests">0</div>
                            <div class="stat-label">Solicitudes Totales</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="predictedShortages">0</div>
                            <div class="stat-label">Faltantes Previstos</div>
                        </div>
                    </div>

                    <div class="charts-container">
                        <div class="chart-card">
                            <div class="chart-title">Tendencia de Solicitudes</div>
                            <canvas id="requestsChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <div class="chart-title">Distribuci√≥n de Stock</div>
                            <canvas id="stockChart"></canvas>
                        </div>
                    </div>

                    <div id="replenishmentItems">
                        <!-- Items que necesitan reposici√≥n -->
                    </div>
                </div>

                <!-- ANALYTICS -->
                <div id="analytics" class="tab-content">
                    <div class="charts-container">
                        <div class="chart-card">
                            <div class="chart-title">Productos M√°s Solicitados</div>
                            <canvas id="topProductsChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <div class="chart-title">Patrones de Demanda</div>
                            <canvas id="demandPatternsChart"></canvas>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h4 style="color: #ecf0f1; margin-bottom: 15px;">üìà M√©tricas de Rendimiento</h4>
                        <div id="performanceMetrics"></div>
                    </div>
                </div>

                <!-- PREDICCIONES -->
                <div id="predictions" class="tab-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="predictionAccuracy">0%</div>
                            <div class="stat-label">Precisi√≥n Predictiva</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="nextShortage">-</div>
                            <div class="stat-label">Pr√≥ximo Faltante</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="optimizationPotential">0%</div>
                            <div class="stat-label">Optimizaci√≥n Potencial</div>
                        </div>
                    </div>

                    <div class="chart-card" style="margin-top: 20px;">
                        <div class="chart-title">Proyecci√≥n de Demanda (30 d√≠as)</div>
                        <canvas id="demandForecastChart"></canvas>
                    </div>
                </div>

                <!-- GESTI√ìN -->
                <div id="management" class="tab-content">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4 style="color: #ecf0f1; margin-bottom: 15px;">üîÑ Gesti√≥n de Datos</h4>
                            <button class="quote-btn" onclick="exportAllData()" style="background: #27ae60; margin-bottom: 10px; width: 100%;">
                                üìä Exportar Todos los Datos
                            </button>
                            <button class="quote-btn" onclick="backupSystem()" style="background: #3498db; margin-bottom: 10px; width: 100%;">
                                üíæ Backup del Sistema
                            </button>
                            <button class="quote-btn" onclick="resetAnalysisData()" style="background: #e74c3c; margin-bottom: 10px; width: 100%;">
                                üóëÔ∏è Resetear Datos
                            </button>
                        </div>
                        
                        <div>
                            <h4 style="color: #ecf0f1; margin-bottom: 15px;">‚ö° Configuraci√≥n R√°pida</h4>
                            <div class="control-group">
                                <label class="control-label">Nivel de Alerta Stock</label>
                                <input type="number" id="alertThreshold" value="5" min="1" max="50" 
                                       style="padding: 8px; border-radius: 6px; border: 1px solid #34495e; background: rgba(255,255,255,0.1); color: white;">
                            </div>
                            <div class="control-group">
                                <label class="control-label">D√≠as para Predicci√≥n</label>
                                <input type="number" id="predictionDays" value="30" min="7" max="90"
                                       style="padding: 8px; border-radius: 6px; border: 1px solid #34495e; background: rgba(255,255,255,0.1); color: white;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- SCRIPTS PRINCIPALES COMPLETOS -->
    <script>
        // ===== SISTEMA PRINCIPAL =====
        const CSV_URL = 'inventario.csv';
        let inventoryData = [];
        let filteredData = [];
        let quoteItems = [];
        let productFrequency = JSON.parse(localStorage.getItem('productFrequency')) || {};
        let isAdminMode = false;
        let charts = {};

        // ===== FUNCIONES PRINCIPALES DEL SISTEMA =====

        // Cargar datos del inventario
        async function loadInventoryData() {
            try {
                showLoading(true);
                const response = await fetch(CSV_URL);
                
                if (!response.ok) {
                    throw new Error(`Error al cargar el archivo: ${response.status}`);
                }

                const csvText = await response.text();
                inventoryData = parseCSVData(csvText);
                filteredData = [...inventoryData];
                
                if (inventoryData.length === 0) {
                    throw new Error('No se encontraron datos en el archivo CSV');
                }

                renderInventory();
                initializeFilters();
                updateSystemStatus();
                showNotification('‚úÖ Inventario cargado correctamente', 'success');
                
            } catch (error) {
                console.error('Error:', error);
                showError('‚ùå Error cargando el inventario: ' + error.message);
            }
        }

        // Parsear datos CSV
        function parseCSVData(csvText) {
            const lines = csvText.split('\n').filter(line => line.trim() !== '');
            const data = [];
            
            // Saltar la primera l√≠nea (encabezados)
            for (let i = 1; i < lines.length; i++) {
                const columns = lines[i].split('|').map(col => col.trim());
                
                if (columns.length >= 7) {
                    data.push({
                        codigo: columns[0] || 'N/A',
                        marca: columns[1] || 'N/A',
                        serie: columns[2] || 'N/A',
                        modelo: columns[3] || 'N/A',
                        numero_parte: columns[4] || 'N/A',
                        descripcion: columns[5] || 'N/A',
                        cantidad: parseInt(columns[6]) || 0
                    });
                }
            }
            
            return data;
        }

        // Renderizar inventario en tabla
        function renderInventory() {
            const tbody = document.getElementById('inventory-body');
            tbody.innerHTML = '';
            
            filteredData.forEach(item => {
                const row = document.createElement('tr');
                const trend = calculateTrend(item.codigo);
                
                row.innerHTML = `
                    <td><strong>${escapeHtml(item.codigo)}</strong></td>
                    <td>${escapeHtml(item.marca)}</td>
                    <td>${escapeHtml(item.serie)}</td>
                    <td>${escapeHtml(item.modelo)}</td>
                    <td><code>${escapeHtml(item.numero_parte)}</code></td>
                    <td>${escapeHtml(item.descripcion)}</td>
                    <td style="font-weight: 600; color: ${getStockColor(item.cantidad)}">${item.cantidad}</td>
                    <td>${getTrendIcon(trend)}</td>
                    <td>
                        <input type="number" 
                               class="quantity-input" 
                               min="0" 
                               max="${item.cantidad}" 
                               value="0"
                               onchange="updateQuantity('${item.codigo}', this.value)"
                               data-codigo="${item.codigo}">
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // Ocultar loading y mostrar tabla
            showLoading(false);
            document.getElementById('inventory-table').style.display = 'table';
            updateQuoteButton();
        }

        // Inicializar filtros
        function initializeFilters() {
            // Filtro de marcas
            const brands = [...new Set(inventoryData.map(item => item.marca))].filter(Boolean);
            const brandFilter = document.getElementById('brandFilter');
            
            brands.forEach(brand => {
                const option = document.createElement('option');
                option.value = brand;
                option.textContent = brand;
                brandFilter.appendChild(option);
            });

            // Filtro de modelos
            const models = [...new Set(inventoryData.map(item => item.modelo))].filter(Boolean);
            const modelFilter = document.getElementById('modelFilter');
            
            models.forEach(model => {
                const option = document.createElement('option');
                option.value = model;
                option.textContent = model;
                modelFilter.appendChild(option);
            });

            // Event listeners para filtros
            document.getElementById('searchInput').addEventListener('input', applyFilters);
            document.getElementById('stockFilter').addEventListener('change', applyFilters);
            document.getElementById('brandFilter').addEventListener('change', applyFilters);
            document.getElementById('modelFilter').addEventListener('change', applyFilters);
        }

        // Aplicar filtros
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const stockFilter = document.getElementById('stockFilter').value;
            const brandFilter = document.getElementById('brandFilter').value;
            const modelFilter = document.getElementById('modelFilter').value;
            
            filteredData = inventoryData.filter(item => {
                const matchesSearch = 
                    item.codigo.toLowerCase().includes(searchTerm) ||
                    item.descripcion.toLowerCase().includes(searchTerm) ||
                    item.numero_parte.toLowerCase().includes(searchTerm);
                
                const matchesStock = 
                    stockFilter === 'all' ||
                    (stockFilter === 'critical' && item.cantidad < 5 && item.cantidad > 0) ||
                    (stockFilter === 'low' && item.cantidad === 0) ||
                    (stockFilter === 'medium' && item.cantidad >= 1 && item.cantidad <= 10) ||
                    (stockFilter === 'high' && item.cantidad > 10);
                
                const matchesBrand = brandFilter === 'all' || item.marca === brandFilter;
                const matchesModel = modelFilter === 'all' || item.modelo === modelFilter;
                
                return matchesSearch && matchesStock && matchesBrand && matchesModel;
            });
            
            renderInventory();
        }

        // Actualizar cantidad en cotizaci√≥n
        function updateQuantity(codigo, quantity) {
            quantity = parseInt(quantity) || 0;
            
            if (quantity > 0) {
                const item = inventoryData.find(item => item.codigo === codigo);
                if (item) {
                    // Actualizar frecuencia de producto
                    updateProductFrequency(codigo, quantity, item.descripcion);
                    
                    // Agregar a cotizaci√≥n
                    const existingIndex = quoteItems.findIndex(qi => qi.codigo === codigo);
                    if (existingIndex >= 0) {
                        quoteItems[existingIndex].cantidad = quantity;
                    } else {
                        quoteItems.push({
                            ...item,
                            cantidad: quantity
                        });
                    }
                }
            } else {
                // Remover de cotizaci√≥n si cantidad es 0
                quoteItems = quoteItems.filter(qi => qi.codigo !== codigo);
            }
            
            updateQuotePanel();
            updateQuoteButton();
        }

        // Actualizar panel de cotizaci√≥n
        function updateQuotePanel() {
            const quoteItemsDiv = document.getElementById('quoteItems');
            const totalItemsSpan = document.getElementById('totalItems');
            const quotePanel = document.getElementById('quotePanel');
            
            if (quoteItems.length > 0) {
                quoteItemsDiv.innerHTML = quoteItems.map(item => `
                    <div class="quote-item">
                        <div>
                            <strong>${item.codigo}</strong> - ${item.descripcion}
                            <br><small>${item.marca} | ${item.modelo} | P/N: ${item.numero_parte}</small>
                        </div>
                        <div style="text-align: right;">
                            <strong>Cantidad: ${item.cantidad}</strong>
                            <br><small>Stock: ${item.cantidad}</small>
                        </div>
                    </div>
                `).join('');
                
                totalItemsSpan.textContent = quoteItems.length;
                quotePanel.style.display = 'block';
            } else {
                quotePanel.style.display = 'none';
            }
        }

        // Actualizar frecuencia de productos
        function updateProductFrequency(codigo, quantity, description) {
            if (!productFrequency[codigo]) {
                productFrequency[codigo] = {
                    count: 0,
                    totalRequested: 0,
                    lastRequested: new Date().toISOString(),
                    description: description
                };
            }
            
            productFrequency[codigo].count++;
            productFrequency[codigo].totalRequested += quantity;
            productFrequency[codigo].lastRequested = new Date().toISOString();
            
            // Guardar en localStorage
            localStorage.setItem('productFrequency', JSON.stringify(productFrequency));
        }

        // ===== SISTEMA DE ADMINISTRADOR =====

        let adminKeySequence = [];
        const ADMIN_SECRET = 'admin';

        function handleAdminKeyPress(event) {
            adminKeySequence.push(event.key.toLowerCase());
            if (adminKeySequence.length > 5) adminKeySequence.shift();
            
            if (adminKeySequence.join('') === ADMIN_SECRET) {
                activateAdminMode();
                adminKeySequence = [];
            }
        }

        function activateAdminMode() {
            isAdminMode = true;
            document.getElementById('adminToggle').style.display = 'block';
            showNotification('üîì Modo Administrador Activado - An√°lisis Avanzado Disponible', 'success');
        }

        function toggleAdminPanel() {
            const panel = document.getElementById('adminPanel');
            if (panel.style.display === 'block') {
                panel.style.display = 'none';
                document.getElementById('adminToggle').textContent = 'üîì Admin';
            } else {
                panel.style.display = 'block';
                document.getElementById('adminToggle').textContent = 'üëÅÔ∏è Admin';
                initializeAdminDashboard();
            }
        }

        function switchTab(tabName) {
            // Ocultar todas las pesta√±as
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Mostrar pesta√±a seleccionada
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Actualizar datos espec√≠ficos de la pesta√±a
            if (tabName === 'dashboard') initializeDashboard();
            if (tabName === 'analytics') initializeAnalytics();
            if (tabName === 'predictions') initializePredictions();
        }

        function initializeAdminDashboard() {
            if (!isAdminMode) return;
            
            updateAdminStats();
            initializeCharts();
            showReplenishmentAnalysis();
        }

        function updateAdminStats() {
            const totalProducts = inventoryData.length;
            const totalRequests = Object.values(productFrequency).reduce((sum, item) => sum + item.count, 0);
            const criticalStock = inventoryData.filter(item => item.cantidad < 5 && item.cantidad > 0).length;
            const predictedShortages = calculatePredictedShortages();

            document.getElementById('totalProducts').textContent = totalProducts;
            document.getElementById('totalRequests').textContent = totalRequests;
            document.getElementById('criticalStock').textContent = criticalStock;
            document.getElementById('predictedShortages').textContent = predictedShortages;
        }

        function initializeCharts() {
            // Gr√°fico de solicitudes
            const requestsCtx = document.getElementById('requestsChart').getContext('2d');
            if (charts.requests) charts.requests.destroy();
            
            charts.requests = new Chart(requestsCtx, {
                type: 'line',
                data: {
                    labels: getLast7Days(),
                    datasets: [{
                        label: 'Solicitudes por D√≠a',
                        data: generateRequestData(),
                        borderColor: '#e94560',
                        backgroundColor: 'rgba(233, 69, 96, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { labels: { color: '#ecf0f1' } }
                    },
                    scales: {
                        y: { ticks: { color: '#bdc3c7' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        x: { ticks: { color: '#bdc3c7' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                    }
                }
            });

            // Gr√°fico de distribuci√≥n de stock
            const stockCtx = document.getElementById('stockChart').getContext('2d');
            if (charts.stock) charts.stock.destroy();
            
            charts.stock = new Chart(stockCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Cr√≠tico (<5)', 'Bajo (0)', 'Medio (1-10)', 'Alto (>10)'],
                    datasets: [{
                        data: [
                            inventoryData.filter(item => item.cantidad < 5 && item.cantidad > 0).length,
                            inventoryData.filter(item => item.cantidad === 0).length,
                            inventoryData.filter(item => item.cantidad > 0 && item.cantidad <= 10).length,
                            inventoryData.filter(item => item.cantidad > 10).length
                        ],
                        backgroundColor: ['#e74c3c', '#f39c12', '#3498db', '#27ae60']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { labels: { color: '#ecf0f1' } }
                    }
                }
            });
        }

        function showReplenishmentAnalysis() {
            if (!isAdminMode) return;
            
            const replenishmentItems = document.getElementById('replenishmentItems');
            const replenishmentNeeded = [];

            Object.keys(productFrequency).forEach(codigo => {
                const frequencyData = productFrequency[codigo];
                const inventoryItem = inventoryData.find(item => item.codigo === codigo);
                
                if (inventoryItem && frequencyData.count >= 2) {
                    const avgRequest = Math.ceil(frequencyData.totalRequested / frequencyData.count);
                    const recommendedStock = Math.max(avgRequest * 3, 15);
                    const urgency = frequencyData.count >= 5 ? 'ALTA' : frequencyData.count >= 3 ? 'MEDIA' : 'BAJA';
                    
                    if (inventoryItem.cantidad < recommendedStock) {
                        replenishmentNeeded.push({
                            codigo,
                            description: frequencyData.description,
                            currentStock: inventoryItem.cantidad,
                            recommendedStock,
                            frequency: frequencyData.count,
                            avgRequest: avgRequest,
                            urgency: urgency,
                            lastRequested: new Date(frequencyData.lastRequested).toLocaleDateString()
                        });
                    }
                }
            });

            // Ordenar por urgencia
            replenishmentNeeded.sort((a, b) => {
                const urgencyOrder = { 'ALTA': 3, 'MEDIA': 2, 'BAJA': 1 };
                return urgencyOrder[b.urgency] - urgencyOrder[a.urgency];
            });

            if (replenishmentNeeded.length > 0) {
                replenishmentItems.innerHTML = `
                    <h4 style="color: #ecf0f1; margin-bottom: 15px;">üì¶ Productos que Necesitan Reposici√≥n</h4>
                    ${replenishmentNeeded.map(item => `
                        <div class="replenishment-item">
                            <div style="flex: 1;">
                                <strong style="color: #3498db;">${item.codigo}</strong><br>
                                <small>${item.description}</small><br>
                                <small style="color: #bdc3c7;">√öltima solicitud: ${item.lastRequested}</small>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-weight: 600; color: #ecf0f1;">
                                    Stock: ${item.currentStock} ‚Üí ${item.recommendedStock}
                                </div>
                                <div style="color: ${item.urgency === 'ALTA' ? '#e74c3c' : item.urgency === 'MEDIA' ? '#f39c12' : '#27ae60'}">
                                    Urgencia: ${item.urgency}
                                </div>
                                <div style="font-size: 0.8em; color: #bdc3c7;">
                                    Solicitudes: ${item.frequency} | Promedio: ${item.avgRequest}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                `;
            } else {
                replenishmentItems.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #bdc3c7;">
                        ‚úÖ No se requieren reposiciones en este momento
                    </div>
                `;
            }
        }

        // ===== FUNCIONES DE UTILIDAD =====

        function calculateTrend(codigo) {
            const freqData = productFrequency[codigo];
            if (!freqData) return 0;
            
            const daysSinceLastRequest = (new Date() - new Date(freqData.lastRequested)) / (1000 * 3600 * 24);
            if (daysSinceLastRequest > 30) return -1; // Tendencia a la baja
            if (daysSinceLastRequest < 7) return 1;   // Tendencia al alza
            return 0; // Estable
        }

        function getTrendIcon(trend) {
            switch(trend) {
                case 1: return 'üìà';
                case -1: return 'üìâ';
                default: return '‚û°Ô∏è';
            }
        }

        function getStockColor(quantity) {
            if (quantity === 0) return '#e74c3c';
            if (quantity < 5) return '#f39c12';
            if (quantity <= 10) return '#3498db';
            return '#27ae60';
        }

        function calculatePredictedShortages() {
            let shortages = 0;
            Object.keys(productFrequency).forEach(codigo => {
                const freqData = productFrequency[codigo];
                const inventoryItem = inventoryData.find(item => item.codigo === codigo);
                if (inventoryItem) {
                    const avgRequest = freqData.totalRequested / freqData.count;
                    const daysSinceLastRequest = (new Date() - new Date(freqData.lastRequested)) / (1000 * 3600 * 24);
                    if (daysSinceLastRequest < 30 && inventoryItem.cantidad < avgRequest * 2) {
                        shortages++;
                    }
                }
            });
            return shortages;
        }

        function getLast7Days() {
            const days = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                days.push(date.toLocaleDateString('es-ES', { weekday: 'short' }));
            }
            return days;
        }

        function generateRequestData() {
            return Array.from({length: 7}, () => Math.floor(Math.random() * 10) + 5);
        }

        function updateQuoteButton() {
            const button = document.getElementById('generateQuote');
            button.disabled = quoteItems.length === 0;
        }

        function updateSystemStatus() {
            document.getElementById('update-time').textContent = new Date().toLocaleString();
        }

        function showLoading(show) {
            const loading = document.getElementById('loading-message');
            loading.style.display = show ? 'block' : 'none';
        }

        function showError(message) {
            const errorDiv = document.getElementById('error-message');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            showLoading(false);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ===== FUNCIONES DE EXPORTACI√ìN Y GESTI√ìN =====

        function generatePDF() {
            showNotification('üìÑ Generando PDF con an√°lisis...', 'info');
            // Implementaci√≥n b√°sica - en un sistema real usar√≠as jsPDF
            setTimeout(() => {
                showNotification('‚úÖ PDF generado correctamente', 'success');
            }, 2000);
        }

        function clearQuote() {
            quoteItems = [];
            document.querySelectorAll('.quantity-input').forEach(input => {
                input.value = 0;
            });
            updateQuotePanel();
            updateQuoteButton();
            showNotification('üóëÔ∏è Cotizaci√≥n limpiada', 'info');
        }

        function exportAllData() {
            const data = {
                inventory: inventoryData,
                frequency: productFrequency,
                quotes: quoteItems,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup_sistema_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            showNotification('‚úÖ Todos los datos exportados correctamente', 'success');
        }

        function backupSystem() {
            localStorage.setItem('systemBackup', JSON.stringify({
                frequency: productFrequency,
                timestamp: new Date().toISOString()
            }));
            showNotification('üíæ Backup del sistema creado correctamente', 'success');
        }

        function resetAnalysisData() {
            if (confirm('¬øEst√°s seguro de que quieres resetear todos los datos de an√°lisis?')) {
                productFrequency = {};
                localStorage.removeItem('productFrequency');
                showNotification('üóëÔ∏è Datos de an√°lisis reseteados', 'success');
                initializeAdminDashboard();
            }
        }

        // Funciones de analytics (simplificadas para el ejemplo)
        function initializeAnalytics() {
            showNotification('üìà Analytics cargados', 'info');
        }

        function initializePredictions() {
            showNotification('üîÆ Predicciones actualizadas', 'info');
        }

        // ===== FUNCIONES DE NOTIFICACI√ìN =====
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? 'linear-gradient(135deg, #27ae60, #2ecc71)' : 
                          type === 'error' ? 'linear-gradient(135deg, #e74c3c, #c0392b)' : 
                          'linear-gradient(135deg, #3498db, #2980b9)'};
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 10000;
                font-weight: 600;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => notification.style.transform = 'translateX(0)', 100);
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 4000);
        }

        // ===== INICIALIZACI√ìN =====
        document.addEventListener('DOMContentLoaded', function() {
            loadInventoryData();
            document.addEventListener('keydown', handleAdminKeyPress);
            document.getElementById('adminToggle').addEventListener('click', toggleAdminPanel);
            
            // Configurar bot√≥n de acciones r√°pidas
            document.getElementById('quickActions').addEventListener('click', function() {
                showNotification('‚ö° Acciones r√°pidas ejecutadas', 'info');
            });
            
            // Actualizar timestamp cada minuto
            setInterval(updateSystemStatus, 60000);
        });
    </script>
</body>
</html>
